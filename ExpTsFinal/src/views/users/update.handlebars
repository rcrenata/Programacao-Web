<div class="row justify-content-center">
    <div class="col-md-6">
        <h1 class="text-center">Atualizar Usuário: {{user.fullname}}</h1>

        {{#if error}}
            <div class="alert alert-danger">{{error}}</div>
        {{/if}}

        <form action="/users/update/{{user.id}}" method="POST">
            <div class="mb-3">
                <label for="fullname" class="form-label">Nome Completo</label>

                <input type="text" class="form-control" id="fullname" name="fullname" value="{{#if oldInput}}{{oldInput.fullname}}{{else}}{{user.fullname}}{{/if}}" required>
            </div>

            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" name="email" value="{{#if oldInput}}{{oldInput.email}}{{else}}{{user.email}}{{/if}}" required>
            </div>

            <div class="mb-3">
                <label for="major_id" class="form-label">Curso</label>
                <select class="form-select" id="major_id" name="major_id" required>
                    <option value="" disabled>Selecione um curso...</option>
                    {{#each majors}}
                        {{! CORREÇÃO: Lógica de seleção simplificada }}
                        <option value="{{this.id}}" {{#eq this.id ../user.major_id}}selected{{/eq}}>
                            {{this.name}} ({{this.code}})
                        </option>
                    {{/each}}
                </select>
            </div>

            <button type="submit" class="btn btn-primary w-100">Atualizar Dados</button>
            <a href="/users/read/{{user.id}}" class="btn btn-secondary w-100 mt-2">Cancelar</a>
        </form>
    </div>
</div>